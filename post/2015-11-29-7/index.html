<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="gdb, 调试, gdb调试, 教程, 调试教程, ">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="gdb调试 : frederick.sun"/>
<meta property="og:site_name" content="nanshu wang blog"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="http://sun-friderick.github.io/post/2015-11-29-7">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2015-11-29"/>
<meta property="article:modified_time" content="2015-11-29"/>



<meta property="article:tag" content="gdb">
<meta property="article:tag" content="调试">
<meta property="article:tag" content="gdb调试">
<meta property="article:tag" content="教程">
<meta property="article:tag" content="调试教程">





    <base href="http://sun-friderick.github.io/">
    <title> gdb调试 - frederick.sun </title>
    <link rel="canonical" href="http://sun-friderick.github.io/post/2015-11-29-7">
    

    <link href='http://fonts.useso.com/css?family=Fjalla+One|Open+Sans:300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/static/css/style.css">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?a79535ca63291dc820e3ecefa615aad1";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>

</head>

<body lang="en" itemscope itemtype="http://schema.org/Article">
<header id="header">
	<nav id="nav">
	<div id="title"><a href="/">Frederick Sun</a></div>
    <div><a href=mailto: mrsun.echo@gmail.com target="_blank" class="mailto"> </span> <span class="icon-mail"></span>eric</a></div>
	</nav>
    <nav id="nav">
    	        <ul id="mainnav">
            <li>
                <a href="/bar-work/">
                <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span> 
                <span> 工作 </span>
            </a>
            </li>
            <li>
            <a href="/bar-technology/">
                <span class="icon"> <i aria-hidden="true" class="icon-stats"></i></span>
                <span> 技术 </span>
            </a>
            </li>
            <li>
            <a href="/bar-favor/">
                <span class="icon"> <i aria-hidden="true" class="icon-leaf"></i></span>
                <span> 爱好 </span>
            </a>
            </li>
            
            <li>
            <a href="/bar-living/">
                <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
                <span> 生活 </span>
            </a>
            </li>
            
            <li>
            <a href="/tags/">
                <span class="icon"> <i aria-hidden="true" class="icon-pencil"></i></span>
                <span> Tags </span>
            </a>
            </li>
            
            <li>
            <a href="/about">
                <span class="icon"> <i aria-hidden="true" class="icon-heart"></i></span>
                <span> 关于 </span>
            </a>
            </li>
        </ul>

    </nav>
    <nav id="nav">
       	        <ul id="social">
            
            <li id="share">
                <span class="title"> 友链 </span>
                <div class="dropdown share">
                    <ul class="social">
                      <li> <a href="http://xgezhang.com" target="_blank" title="xge技术博客" class="twitter">xge</a> </li>
                      <li> <a href="http://spf13.com" target="_blank" title="spf13 is Steve Francis" class="facebook">spf13</a> </li>
                      <li> <a href="http://libaier.net" target="_blank" title="Libaier" class="rss">Libaier</a> </li>
                      <li> <a href="http://read.douban.com/column/195295/" target="_blank" title="100个故事" class="douban">一百个故事</a></li>
                      <li> <a href="http://zhangwenli.com/blog/" target="_blank" title="羡辙杂俎" class="yangzhe">羡辙杂俎</a></li>
	      <li> <a href="http://nanshu.wang/" target="_blank" title="Hugo博客" class="hugo">Hugo博客</a></li>
                    </ul>
                <span class="icon icon-bubbles"> </span> <span class="subcount"></span> </div>
            </li>
                
            <li id="follow">
                <span class="title"> 驻留地 </span>
                <div class="dropdown follow">
                    <ul class="social">
                    
                        <li> <a href="http://weibo.com/2235647167/profile/" target="_blank" title="微博" class="weibo">微博</a> </li>
                        <li> <a href="http://www.doc88.com/123_echo_" target="_blank" title="道客巴巴" class="doc88">道客巴巴</a> </li>
                        <li> <a href="http://www.zhihu.com/people/eric-sun-11" target="_blank" title="知乎" class="zhihu">知乎</a> </li>
                        <li> <a href="http://github.com/sun-friderick/" target="_blank" title="GitHub" class="github">GitHub</a> </li>                         
                        <li> <a href="http://www.cnblogs.com/sun-frederick/" target="_blank" title="博客园" class="cnblogs"> 博客园</a></li>
                        <li> <a href="http://instagram.com/ainedrag22" target="_blank" title="Instagram" class="instagram">Instagram</a> </li>
                        
                    </ul>
                <span class="icon icon-rocket"> </span> <span class="subcount"></span> </div>
            </li>
            
            
        </ul>

	</nav>
</header>



<section id="main">
  <h1 itemprop="name" >gdb调试</h1>
  

<aside id="meta">

    <div>
        <section id="datecount">
          <h4 id="date"> Sun Nov 29, 2015 </h4>
          
        </section>
        
        <ul id="tags">
          
            <li> <a href="http://sun-friderick.github.io//tags/gdb">gdb</a> </li>
          
            <li> <a href="http://sun-friderick.github.io//tags/%E8%B0%83%E8%AF%95">调试</a> </li>
          
            <li> <a href="http://sun-friderick.github.io//tags/gdb%E8%B0%83%E8%AF%95">gdb调试</a> </li>
          
            <li> <a href="http://sun-friderick.github.io//tags/%E6%95%99%E7%A8%8B">教程</a> </li>
          
            <li> <a href="http://sun-friderick.github.io//tags/%E8%B0%83%E8%AF%95%E6%95%99%E7%A8%8B">调试教程</a> </li>
          
        </ul>
    </div>

</aside>

<meta itemprop="wordCount" content="1421">
<meta itemprop="datePublished" content="2015-11-29">
<meta itemprop="url" content="http://sun-friderick.github.io/post/2015-11-29-7">


  <div>
        <article itemprop="articleBody" id="content">
           

<p>#gdb 跟踪调试命令整理</p>

<h1 id="gdb常用命令:27ab83445e035e5774461847bd2aa236">gdb常用命令：</h1>

<p>|                命令        | 描述           | Cool  |<br />
| &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; |:&mdash;&mdash;&mdash;&mdash;-:|<br />
| backtrace（或bt）    |    查看各级函数调用及参数，运行时的堆栈   |<br />
| finish                              |    连续运行到当前函数返回为止，然后停下来等待命令    |<br />
| frame（或f）帧编号  |   选择栈帧       |<br />
| info（或i） locals       |   查看当前栈帧局部变量的值   |<br />
| list（或l）                     |    列出源代码，接着上次的位置往下列，每次列10行       |<br />
| list 行号                          |   列出从第几行开始的源代码        |<br />
| list 函数名                     |    列出某个函数的源代码   |<br />
| next（或n）                 |    单步调试，执行下一行语句        |<br />
| print（或p）                |    打印表达式的值，通过表达式可以修改变量的值或者调用函数     |<br />
| quit（或q）                 |     退出gdb调试环境  |<br />
| set var                           |     修改变量的值       |<br />
| start                               |     开始执行程序，停在main函数第一行语句前面等待命令       |<br />
| step（或s）                 |     执行下一行语句，如果有函数调用则进入到函数中  |</p>

<p>#GDB 调试</p>

<p>要进行调试程序首先要生成一个含有调试信息的执行程序命令如下:</p>

<pre><code>gcc(g++) -g -o 文件名 源文件.c(源文件.cpp)
gcc(g++) -ggdb3 -o 文件名 源文件.c(源文件.cpp)
</code></pre>

<p>此时便会生成一个含有调试信息的可执行文件,然后便可以用 gdb 去调试这个程序了,进入调试程序命令,但是如果用 gdb 去调试一个未包含调试信息的可执行文件则会发生错误</p>

<pre><code>gdb 执行文件名(含调试信息)
</code></pre>

<p>#运行 GDB</p>

<p>##运行 gdb</p>

<pre><code>gdb &lt;program&gt; -- program也就是你的执行文件,一般在当然目录下.
gdb &lt;program&gt; core -- 用 gdb 同时调试一个运行程序和 core 文件,core 是程序非法执行后 core dump 后产生的文件.
gdb &lt;program&gt; &lt;PID&gt; -- 调试正在运行的程序. program 为需要调试的程序文件, PID 为当前正在运行的程序.或是先用 gdb &lt;program&gt; 关联上源代码进入 gdb,后用 attach 命令来挂接进程的 PID.并用 detach 来取消挂接的进程
</code></pre>

<p>##gdb 启动常用的参数</p>

<pre><code>从指定文件中读取符号表
    -symbols &lt;file&gt;
    -s &lt;file&gt;
从指定文件中读取符号表信息,并把他用在可执行文件中
    -se file
调试时 core dump 的 core 文件
    -core &lt;file&gt;
    -c &lt;file&gt;
加入一个源文件的搜索路径.默认搜索路径是环境变量中 PATH 所定义的路径
    -directory &lt;directory&gt;
    -d &lt;directory&gt;
设置启动时候参数
    --args arglist
</code></pre>

<p>##gdb 帮助文档</p>

<pre><code>help -- 查看 gdb 的命令种类
help &lt;CmdType&gt; -- 查看 CmdType 种类的 gdb 命令
apropos &lt;keyWord&gt; -- 查看关键字 keyWord 的相关命令
info &lt;keyWord&gt; -- 查看关键字 keyWord 调试信息
show &lt;keyWord&gt; -- 查看关键字 keyWord gdb 本身设置信息
</code></pre>

<p>##gdb 中运行 unix 的 shell 程序</p>

<pre><code>shell &lt;command string&gt; -- 调用 unix 的 shell 来执行 &lt;command string&gt;,环境变量 shell 中定义的 unix 的 shell 将会被用来执行 &lt;command string&gt;,如果 shell 没有定义,那就使用 unix 的标准 shell：/bin/sh.(在 windows 中使用 command.com 或 cmd.exe)
make &lt;make-args&gt; -- 等价于 “shell make &lt;make-args&gt;”
</code></pre>

<p>##历史记录</p>

<pre><code>当你用 gdb 的 print 查看程序运行时的数据时,你每一个 print 都会被 gdb 记录下来.gdb 会以 $1, $2, $3 ...这样的方式为你每一个 print 命令编上号.于是,你可以使用这个编号访问以前的表达式,如 $1.这个功能所带来的好处是,如果你先前输入了一个比较长的表达式,如果你还想查看这个表达式的值,你可以使用历史记录来访问,省去了重复输入.
</code></pre>

<p>##启动程序</p>

<pre><code>run &lt;arg ...&gt; -- 启动程序,&lt;arg ...&gt; 为程序运行时候需要输入的参数.也可用 set args 命令去设置运行参数.简写为 r
</code></pre>

<p>#GDB 环境设置</p>

<p>##gdb 设置</p>

<pre><code>设置显示选项
    地址
        set print address &lt;on/off&gt; -- 打开地址输出,当程序显示函数信息时,gdb会显出函数的参数地址.系统默认为打开.
        show print address -- 查看 print address 选项信息
    数组元素单独行显示
        set print array &lt;on/off&gt; -- 打开时数组显示时,每个元素占一行,如果不打开的话,每个元素则以逗号分隔.这个选项默认是关闭的.
        show print array -- 查看 print array 选项信息
    显示数组元素显示
        set print elements &lt;number-of-elements&gt; -- 设置数组的显示的最大长度,设置为 0,则表示不限制.
        show print elements -- 查看 print elements 选项信息.
    设置字符串显示
        set print null-stop &lt;on/off&gt; -- 如果打开那么当显示字符串时,遇到结束符则停止显示.这个选项默认为 off.
        show print null-stop -- 查看 print null-stop 选项信息
    设置结构体变量显示
        set print pretty &lt;on/off&gt; -- 结构体优雅显示
        show print pretty -- 查看 gdb 是如何显示结构体的.
    设置字符显示
        set print sevenbit-strings &lt;on/off&gt; -- 符显示,是否按“/nnn”的格式显示,如果打开,则字符串或字符数据按/nnn显示,如“/065”.
        show print sevenbit-strings -- 查看字符显示开关是否打开.
    设置联合体显示
        set print union &lt;on/off&gt; -- 设置显示结构体时,是否显式其内的联合体数据.
        show print union -- 查看联合体数据的显示方式
    设置对象显示
        set print object &lt;on/off&gt; -- 在 C++ 中,如果一个对象指针指向其派生类,如果打开这个选项,gdb 会自动按照虚方法调用的规则显示输出,如果关闭这个选项的话,gdb 就不管虚函数表了.这个选项默认是 off.
        show print object -- 查看对象选项的设置.
    设置静态成员显示
        set print static-members &lt;on/off&gt; -- 这个选项表示,当显示一个 C++ 对象中的内容是,是否显示其中的静态数据成员.默认是 on.
        show print static-members -- 查看静态数据成员选项设置.
    设置虚函数表显示
        set print vtbl &lt;on/off&gt; -- 当此选项打开时,gdb 将用比较规整的格式来显示虚函数表时.其默认是关闭的.
        show print vtbl -- 查看虚函数显示格式的选项.
设置运行程序的相关环境及其参数
    指定源文件的路径
        directory &lt;dirname ... &gt; -- 加一个源文件路径到当前路径的前面.如果你要指定多个路径,UNIX 下你可以使用“:”,Windows 下你可以使用“;”.缩写 dir
        directory -- 清除所有的自定义的源文件搜索路径信息.
        show directories -- 显示定义了的源文件搜索路径.
    运行参数
        set args -- 可指定运行时参数
        show args -- 命令可以查看设置好的运行参数
    运行环境
        path &lt;dir&gt; -- 可设定程序的运行路径
        show paths -- 查看程序的运行路径
        set environment varname=value -- 设置环境变量
        show environment [varname] -- 查看环境变量
    工作目录
        cd &lt;dir&gt; -- 相当于shell的cd命令
        pwd -- 显示当前的所在目录
    程序的输入输出
        info terminal -- 显示你程序用到的终端的模式
        tty -- 命令可以指写输入输出的终端设备
        重定向控制程序输出
    堆栈帧设置
        set backtrace &lt;limit&gt; -- 设置堆栈帧的最大显示数量,默认是没有限制
    调试模式
        set step-mode [on | off] -- step-mode 模式,于是,在进行单步跟踪时,程序不会因为没有debug信息而不停住.这个参数有很利于查看机器码. 
</code></pre>

<p>#GDB 源码查看</p>

<p>##显示源代码</p>

<pre><code>list &lt;linenum&gt; -- 显示程序第 linenum 行的周围的源程序.
list &lt;function&gt; -- 显示函数名为 function 的函数的源程序.
list &lt;filename:linenum&gt; -- 哪个文件的哪一行.
list &lt;filename:function&gt; -- 哪个文件中的哪个函数.
list &lt;offset&gt; -- 当前行号的正/负 offset 偏移量那那行.
list -- 显示当前行后面的源程序.
list - -- 显示当前行前面的源程序.
list &lt;first&gt;, &lt;last&gt; -- 显示从 first 行到 last 行之间的源代码.若无 first 则显示从当前行到 last 之间的源代码.
</code></pre>

<p>##设置和获得显示源码的行数</p>

<pre><code>set listsize &lt;count&gt; -- 设置一次显示源代码的行数.
show listsize -- 查看当前listsize的设置.
</code></pre>

<p>##搜索源代码</p>

<pre><code>forward-search &lt;regexp&gt; -- 向后面搜索.正则表达式为 regexp 的关键字
search &lt;regexp&gt; -- 向后面搜索.正则表达式为 regexp 的关键字
reverse-search &lt;regexp&gt; -- 向前面搜索.正则表达式为 regexp 的关键字
</code></pre>

<p>##源代码的内存</p>

<pre><code>info line &lt;linenum&gt; -- 查看行号为 linenum 源代码在内存中的地址.
info line &lt;function&gt; -- 查看函数在源代码在内存中的地址.
info line &lt;filename:linenum&gt; -- 查看 filename 文件的第 linenum 行源代码在内存中的地址.
info line &lt;filename:function&gt; -- 查看 filename 文件的 function 函数在源代码在内存中的地址.
</code></pre>

<p>##查看汇编代码</p>

<pre><code>disassemble -- 查看源程序的当前执行时的机器码,这个命令会把目前内存中的指令 dump 出来.
</code></pre>

<p>#GDB 停止点设置及维护</p>

<p>##断点(BreakPoint)</p>

<pre><code>设置断点:(threadno 指定了线程的 ID,注意,这个 ID 是 gdb 分配的,可以通过 &quot;info threads&quot; 命令来查看正在运行程序中的线程信息)
    break thread &lt;threadno&gt; -- break命令没有参数时,表示在下一条指令处停住.
    break +offset thread &lt;threadno&gt; -- 在当前行号的后面的 offset 行停住.(offiset 为自然数)
    break -offset thread &lt;threadno&gt; -- 在当前行号的前面的 offset 行停住.(offiset 为自然数)
    break &lt;linenum&gt; thread &lt;threadno&gt; -- 在指定行号停住.
    break filename:linenum thread &lt;threadno&gt; -- 在源文件filename的linenum行处停住.
    break &lt;function&gt; thread &lt;threadno&gt; -- 在进入指定函数时停住.
    break filename:function thread &lt;threadno&gt; --在源文件filename的function函数的入口处停住.
    break *address -- 在程序运行的内存地址处停住.
    break ... thread &lt;threadno&gt; if &lt;condition&gt; -- ...可以是上述的参数,condition表示条件,在条件成立时停住.比如在循环境体中,可以设置break if i=100,表示当i为100时停住程序.
    tbreak -- 设置只停止一次的断点.用法和 break 类似
查看断点
    info breakpoints [n]
    info break [n]
</code></pre>

<p>##观察点(WatchPoint) &ndash; 观察点一般来观察某个表达式(变量也是一种表达式)的值是否有变化了,如果有变化,马上停住程序.</p>

<pre><code>设在观察点
    watch &lt;expr&gt; -- 为表达式(变量)expr设置一个观察点.一量表达式值有变化时,马上停住程序.
    rwatch &lt;expr&gt; -- 当表达式(变量)expr被读时,停住程序.
    awatch &lt;expr&gt; -- 当表达式(变量)的值被读或被写时,停住程序.
查看观察点
    info watchpoints -- 列出当前所设置了的所有观察点.
</code></pre>

<p>##捕捉点(CatchPoint) &ndash; 设置捕捉点来补捉程序运行时的一些事件.如:载入共享库(动态链接库)或是 C++ 的异常《/p&gt;</p>

<pre><code>设置捕捉点
    catch &lt;event&gt; -- 当event发生时,停住程序.event可以是下面的内容：
        throw 一个 C++ 抛出的异常.(throw 为关键字)
        catch 一个 C++ 捕捉到的异常.(catch 为关键字)
        exec 调用系统调用 exec 时.(exec 为关键字,目前此功能只在 HP-UX 下有用)
        fork 调用系统调用 fork 时.(fork 为关键字,目前此功能只在 HP-UX 下有用)
        vfork 调用系统调用 vfork 时.(vfork 为关键字,目前此功能只在 HP-UX 下有用)
        load 或 load &lt;libname&gt; 载入共享库(动态链接库)时.(load 为关键字,目前此功能只在 HP-UX 下有用)
        unload 或 unload &lt;libname&gt; 卸载共享库(动态链接库)时.(unload 为关键字,目前此功能只在 HP-UX 下有用)
    tcatch &lt;event&gt; -- 只设置一次捕捉点,当程序停住以后,应点被自动删除.
</code></pre>

<p>##维护停止点</p>

<pre><code>清除停止点
    clear -- 所有的已定义的停止点.
    clear &lt;function&gt; -- 清除所有设置在函数上的停止点.
    clear &lt;filename:function&gt; -- 清除所有设置在函数上的停止点.
    clear &lt;linenum&gt; -- 清除所有设置在指定行上的停止点.
    clear &lt;filename:linenum&gt; -- 清除所有设置在指定行上的停止点.
删除停止点
    delete [range] -- 删除停止点.其简写命令为 d.
禁用停止点
    disable [range] -- 禁用停止点
启用停止点
    enable [range] -- 启用停止点.
    enable once [rang] -- 启用停止点一次,当程序停止后,该停止点马上被 gdb 自动 disable.
    enable count [rang] -- 启用停止点 count 次,当程序停止后,该停止点马上被 gdb 自动 disable.
    enable delete [rang] -- 启用停止点一次,当程序停止后,该停止点马上被 gdb 自动删除.
停止条件维护 -- 以用 condition 命令来修改断点的条件.(只有break和watch命令支持if,catch目前暂不支持if)
    condition &lt;bnum&gt; &lt;expression&gt; -- 修改断点号为bnum的停止条件为expression.
    condition &lt;bnum&gt; -- 清除断点号为bnum的停止条件.
忽略停止点 N 次
    ignore &lt;bnum&gt; &lt;count&gt; -- 表示忽略断点号为 bnum 的停止条件 count 次.
为停止点设定运行命令
    格式:
    commands [bnum]
           ... command-list ...
           // 为断点号 bnumi写一个命令列表.当程序被该断点停住时,gdb 依次运行命令列表中的命令.
    end
    例如：
    break foo if x&gt;0
    　　commands
           printf &quot;x is %d/n&quot;,x
           continue
    end
</code></pre>

<p>#信号(Signals)</p>

<p>##添加信号处理</p>

<pre><code>handle &lt;signal&gt; &lt;keywords...&gt;
在 gdb 中定义一个信号处理.信号 &lt;signal&gt; 可以以 SIG 开头或不以 SIG 开头,可以用定义一个要处理信号的范围(如：SIGIO-SIGKILL,表示处理从 SIGIO 信号到 SIGKILL 的信号,其中包括 SIGIO, SIGIOT, SIGKILL 三个信号),也可以使用关键字 all 来标明要处理所有的信号.一旦被调试的程序接收到信号,运行程序马上会被 gdb 停住,以供调试.其 &lt;keywords&gt; 可以是以下几种关键字的一个或多个.若没有 keywords 则查看奇信号的处理状态
    nostop -- 当被调试的程序收到信号时,gdb 不会停住程序的运行,但会打出消息告诉你收到这种信号.
    stop -- 当被调试的程序收到信号时,gdb 会停住你的程序.
    print -- 当被调试的程序收到信号时,gdb 会显示出一条信息.
    noprint -- 当被调试的程序收到信号时,gdb 不会告诉你收到信号的信息.
    pass -- 当被调试的程序收到信号时,gdb 不处理信号.这表示,gdb 会把这个信号交给被调试程序会处理.
    noignore -- 当被调试的程序收到信号时,gdb 不处理信号.这表示,gdb 会把这个信号交给被调试程序会处理.
    nopass -- 当被调试的程序收到信号时,gdb 不处理信号.这表示,gdb 会把这个信号交给被调试程序会处理.
    1gnore -- 当被调试的程序收到信号时,gdb 不会让被调试程序来处理这个信号.
</code></pre>

<p>##查看处理信号</p>

<pre><code>info signals -- 查看有哪些信号在被 gdb 检测中.
info handle -- 查看有哪些信号在被 gdb 检测中.
</code></pre>

<p>#GDB 程序调试</p>

<p>##恢复执行</p>

<pre><code>continue [ignore-count] -- ignore-count 表示忽略其后的断点次数.恢复程序运行,直到程序结束,或是下一个断点到来.缩写 c
fg [ignore-count] -- ignore-count 表示忽略其后的断点次数.恢复程序运行,直到程序结束,或是下一个断点到来.缩写 c
</code></pre>

<p>##单步调试</p>

<pre><code>step &lt;count&gt; -- 单步跟踪,如果有函数调用,它会进入该函数.count 表示执行后面 count 条语句,不加则默认为 1.
next &lt;count&gt; -- 同样单步跟踪,如果有函数调用,他不会进入该函数.count 表示执行后面 count 条语句,不加则默认为 1.
</code></pre>

<p>##跟踪机器指令
       与之一样有相同功能的命令是 “display/i $pc” ,当运行完这个命令后,单步跟踪会在打出程序代码的同时打出机器指令(也就是汇编代码)</p>

<pre><code>stepi 或 si -- 单步跟踪一条机器指令,简写 si
nexti 或 ni -- 单步跟踪一条机器指令,简写 ni
</code></pre>

<p>##函数调试</p>

<pre><code>finish -- 运行程序,直到当前函数完成返回.并打印函数返回时的堆栈地址和返回值及参数值等信息.
return &lt;expression&gt; -- 使函数以 expression 表达式返回出去,忽略还没有执行的语句.若无返回 void 出去
call &lt;expr&gt; -- 表达式中可以一是函数,以此达到强制调用函数的目的.并显示函数的返回值,如果函数返回值是void,那么就不显示.
print 与 printf 也可以做到类似的功能和 call 的不同是,如果函数返回 void,call 则不显示,print 则显示函数返回值,并把该值存入历史数据中.
</code></pre>

<p>##循环体调试</p>

<pre><code>until -- 可以运行程序直到退出循环体.简写 u
</code></pre>

<p>##修改变量值</p>

<pre><code>print varname=var -- 修改被调试程序运行时的变量值
set var varname=value -- 修改被调试程序运行时的变变量
whatis varname -- 查看变量的类型
</code></pre>

<p>##跳转执行</p>

<pre><code>jump &lt;linespec&gt; -- 指定下一条语句的运行点.&lt;linespce&gt; 可以是文件的行号,可以是 file:line 格式,可以是 +num 这种偏移量格式.表式着下一条运行语句从哪里开始.
jump &lt;address&gt; -- 跳转到指定的程序内存地址运行.&lt;address&gt; 是代码行的内存地址.
注意
    jump 指令不会改变当前的程序栈中的内容,所以,当你从一个函数跳到另一个函数时,当函数运行完返回时进行弹栈操作时必然会发生错误.
    jump 命令只是改变了指令寄存器中的值.于是可以使用 “set $pc” 来更改跳转执行的地址.如： set $pc = 0x485
</code></pre>

<p>##产生信号量</p>

<pre><code>signal &lt;signal&gt; -- 产生一个 signal 信号.UNIX 的系统信号量通常从 1 到 15.所以 &lt;signal&gt; 取值也在这个范围.
</code></pre>

<p>#GDB 运行是数据</p>

<p>##查看运行时数据</p>

<pre><code>print /&lt;f&gt; &lt;expr&gt; -- 查看当前程序的运行数据.简写 p.
    &lt;expr&gt; 是表达式
        @ -- 是一个和数组有关的操作符,在后面会有更详细的说明.在 @ 左边是数组的地址,右边是数组的长度,eg: array@len
        :: -- 指定一个在文件或是一个函数中的变量.
        {&lt;type&gt;} &lt;addr&gt; --表示一个指向内存地址&lt;addr&gt;的类型为type的一个对象.
    &lt;f&gt;是输出的格式
        d -- 按十进制格式显示变量.
        u -- 按十六进制格式显示无符号整型.
        o -- 按八进制格式显示变量.
        t -- 按二进制格式显示变量.
        a -- 按十六进制格式显示变量.
        c -- 按字符格式显示变量.
        f -- 按浮点数格式显示变量.
    注意:
        1.若出现变量重名,局部变量会隐藏全局变量.若想查看全局变量的值时,可以使用“::”操作符.
        2.可以通过这种形式指定你所想查看的变量 eg:
            *'filename'::variable
            *function::variable
printf &quot;fmt&quot;,arg,... -- 打印格式化字符灿 fmt.
</code></pre>

<p>##查看内存</p>

<pre><code>examine/&lt;n/f/u&gt; &lt;addr&gt; -- 来查看内存地址中的值.简写 x
    &lt;n/f/u&gt;
        n 是一个正整数,表示显示内存的长度,也就是说从当前地址向后显示几个地址的内容.
        f 表示显示的格式
            s -- 按字符串格式显示内存地址内容.
            i -- 查看内存地址的机器指令内容
            x -- 按十六进制格式显示地址内容.
            d -- 按十进制格式显示地址内容.
            u -- 按十六进制格式显示无符号整型.
            o -- 按八进制格式显示地址内容.
            t -- 按二进制格式显示地址内容.
            a -- 按十六进制格式显示地址内容.
            c -- 按字符格式显示地址内容.
            f -- 按浮点数格式显示地址内容.
        u 表示从当前地址往后请求的字节数,如果不指定的话,gdb默认是 4 个 bytes.
            b -- 表示单字节
            h -- 表示双字节
            w -- 表示四字节
            g -- 表示八字节
    &lt;addr&gt; 表示一个内存地址.
</code></pre>

<p>##自动显示</p>

<pre><code>设置自动显示
    display/&lt;fmt&gt; &lt;expr&gt; -- 自动显示 expr 表达式
    display/&lt;fmt&gt; &lt;addr&gt; -- 自动显示 addr 地址
        fmt 表示显示的格式
        i -- 输出格式为机器指令码,也就是汇编.
        s -- 输出格式为字符串
删除自动显示
    undisplay &lt;range&gt; -- 删除自动显示
    delete display &lt;range&gt; -- 删除自动显示
启用和禁自动显示
    sable display &lt;range&gt; -- 禁用自动显示
    enable display &lt;range&gt; -- 启动自动显示
</code></pre>

<p>##查看栈信息</p>

<pre><code>backtrace &lt;n&gt; -- 擦看函数栈信息,简写 bt
    n 若是正数,只打印栈顶上 n 层的栈信息,
    若是负数,只打印栈顶下 n 层的栈信息,
    若无则打印当前的函数调用栈的所有信息
frame -- 会打印出这些信息:栈的层编号,当前的函数名,函数参数值,函数所在文件及行号,函数执行到的语句.
info frame -- 这个命令会打印出更为详细的当前栈层的信息,只不过,大多数都是运行时的内内地址.
info args -- 打印出当前函数的参数名及其值.
info locals -- 打印出当前函数中所有局部变量及其值.
info catch -- 打印出当前的函数中的异常处理信息.
</code></pre>

<p>##切换函数栈位置</p>

<pre><code>frame &lt;n&gt; -- 切换到第 n 层函数栈位置,简写 f.
p &lt;n&gt; -- 表示上面移动 n 层,可以不打 n,表示向上移动一层.
down &lt;n&gt; -- 表示向栈的下面移动 n 层,可以不打 n,表示向下移动一层.
select-frame &lt;n&gt; -- 类似 frame 命令.不打印出栈层信息.
up-silently &lt;n&gt; -- 类似 up 命令.不打印出栈层信息.
down-silently &lt;n&gt; -- 类似 down 命令.不打印出栈层信息.
</code></pre>

<p>##查看寄存器</p>

<pre><code>info registers -- 查看寄存器的情况.(除了浮点寄存器)
info all-registers -- 查看所有寄存器的情况.(包括浮点寄存器)
info registers &lt;regname&gt; -- 查看所指定的寄存器的情况.
</code></pre>

<p>##线程查看与切换线程</p>

<pre><code>info threads -- 查看当前线程
thread &lt;threadno&gt; -- 切换到 threadno 的线程,简写 t
</code></pre>

<p>#自定义命令</p>

<p>##定义一个命令</p>

<pre><code>格式
define comdName
      ...
end
条件语句
if cond_expr
      ...
else
      ...
end
循环语句
while cond_expr
      ...
end
</code></pre>

<p>##定义一个命令的文档信息（在 help cmdName 的时候显示）</p>

<pre><code>document cmdName
      ...
end
</code></pre>

<p>##查看自定命令</p>

<pre><code>help user-define -- 查看所有用户自定义的命令
show user cmdName -- 查看用户定义的 cmdName 的命令.
help cmdName -- 查看用户自定义的 cmdName 的帮助文档
show max-user-call-depth -- 查看用户自定义命令的递归最大深度,缺省是 1024
set-user-call-depth &lt;limit&gt;-- 设置用户自定义命令的递归最大深度.
</code></pre>

        </article>
  </div>
</section>

<aside id=comments>
    <div><h2> Comments </h2></div>
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'frederick-sun';
    var disqus_identifier = 'http:\/\/sun-friderick.github.io\/post\/2015-11-29-7';
    var disqus_title = 'gdb调试';
    var disqus_url = 'http:\/\/sun-friderick.github.io\/post\/2015-11-29-7';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</aside>

<footer>
  <div>
    <p>
    &copy; 2015 <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Frederick Sun.</span></span>
        Powered by <a href="http://hugo.spf13.com">Hugo</a>.
        Theme by <a href="http://spf13.com">Steve Francia</a>.
    </p>
  </div>
</footer>
<script type="text/javascript">
(function(){var j=function(a,b){return window.getComputedStyle?getComputedStyle(a).getPropertyValue(b):a.currentStyle[b]};var k=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent('on'+b,c)};var l=function(a,b){for(key in b)if(b.hasOwnProperty(key))a[key]=b[key];return a};window.fitText=function(d,e,f){var g=l({'minFontSize':-1/0,'maxFontSize':1/0},f);var h=function(a){var b=e||1;var c=function(){a.style.fontSize=Math.max(Math.min(a.clientWidth/(b*10),parseFloat(g.maxFontSize)),parseFloat(g.minFontSize))+'px'};c();k(window,'resize',c)};if(d.length)for(var i=0;i<d.length;i++)h(d[i]);else h(d);return d}})();
fitText(document.getElementById('title'), 1)
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>






<style> 
    BODY {
        min-height:800px;
    }
    #goTopBtn {
        POSITION: fixed; TEXT-ALIGN: center; LINE-HEIGHT: 50px; WIDTH: 50px; BOTTOM: 35px; HEIGHT: 50px; FONT-SIZE: 12px; CURSOR: pointer; RIGHT: 0px; _position: absolute; _right: auto;
    }
</style>
<script type="text/javascript">
    function goTopEx() { 
        var obj = document.getElementById("goTopBtn"); 
        function getScrollTop() { 
            return document.documentElement.scrollTop + document.body.scrollTop; 
        } 
        function setScrollTop(value) { 
            if (document.documentElement.scrollTop) { 
                document.documentElement.scrollTop = value; 
            } else { 
                document.body.scrollTop = value; 
            } 
        } 
        window.onscroll = function() { 
            getScrollTop() > 0 ? obj.style.display = "": obj.style.display = "none"; 
        } 
        obj.onclick = function() { 
            var goTop = setInterval(scrollMove, 10); 
            function scrollMove() { 
                setScrollTop(getScrollTop() / 1.1); 
            if (getScrollTop() < 1) 
                clearInterval(goTop); 
            } 
        } 
    } 
</script>
<div style="display: none" id="goTopBtn"><img src='/media/top.gif' /></div>
<script type="text/javascript">goTopEx();</script>


</body>
</html>


<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</body>